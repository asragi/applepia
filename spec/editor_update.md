# ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚¨ãƒ‡ã‚£ã‚¿ UIæ”¹ä¿®è¨ˆç”»

## æ¦‚è¦

ã‚µã‚¤ãƒ‰ãƒãƒ¼ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ + ãƒ†ãƒ¼ãƒ–ãƒ«è¡¨ç¤ºå½¢å¼ã‹ã‚‰ã€**ä¸Šéƒ¨ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ + 2ã‚«ãƒ©ãƒ ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ**ã«å¤‰æ›´ã™ã‚‹ã€‚

### æ–°UIæ§‹é€ 

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Master Editor  [ã‚¢ã‚¤ãƒ†ãƒ ][ã‚¹ã‚­ãƒ«][æ¢ç´¢][ã‚¹ãƒ†ãƒ¼ã‚¸]  ğŸ’¾ä¿å­˜ ğŸ”„â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å·¦ã‚«ãƒ©ãƒ  (w-64)         â”‚ å³ã‚«ãƒ©ãƒ  (flex-1)                â”‚
â”‚                        â”‚                                 â”‚
â”‚ [+ æ–°è¦ä½œæˆ]            â”‚ ã‚Šã‚“ã”                 [ğŸ—‘ å‰Šé™¤] â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”‚
â”‚ â— ã‚Šã‚“ã”  â† é¸æŠä¸­     â”‚ ã€ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ ã€‘                  â”‚
â”‚   é»„é‡‘ã‚Šã‚“ã”            â”‚ ItemID: [1        ]              â”‚
â”‚   æœ¨æ                 â”‚ ä¾¡æ ¼:   [200      ]              â”‚
â”‚   ...                  â”‚ åœ¨åº«:   [1000     ]              â”‚
â”‚                        â”‚ ...                             â”‚
â”‚                        â”‚                                 â”‚
â”‚                        â”‚ é–¢é€£ã™ã‚‹æ¢ç´¢:                     â”‚
â”‚                        â”‚  [æ¡é›†] (ç²å¾—: 50-100å€‹) â†’ é·ç§»  â”‚
â”‚                        â”‚  [èª¿ç†] (æ¶ˆè²»)           â†’ é·ç§»  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ä¸€è¦§

### æ–°è¦ä½œæˆ (9ãƒ•ã‚¡ã‚¤ãƒ«)

| ãƒ•ã‚¡ã‚¤ãƒ« | èª¬æ˜ |
|---------|------|
| `components/tab-header/view.tsx` | ä¸Šéƒ¨ã‚¿ãƒ–ãƒãƒ¼ + ä¿å­˜/ãƒªãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ |
| `components/tab-header/index.tsx` | ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ |
| `components/record-list/view.tsx` | å·¦ã‚«ãƒ©ãƒ : ãƒ¬ã‚³ãƒ¼ãƒ‰åãƒªã‚¹ãƒˆ + æ–°è¦ä½œæˆãƒœã‚¿ãƒ³ |
| `components/record-list/index.tsx` | ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ |
| `components/record-detail/view.tsx` | å³ã‚«ãƒ©ãƒ : ã‚¿ã‚¤ãƒˆãƒ« + å‰Šé™¤ãƒœã‚¿ãƒ³ + children |
| `components/record-detail/index.tsx` | ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ |
| `components/field-editor/view.tsx` | ç·¨é›†å¯èƒ½ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ |
| `components/field-editor/index.tsx` | ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ |
| `hooks/useNavigateToRecord.ts` | ã‚¿ãƒ–é–“é·ç§»ãƒ•ãƒƒã‚¯ |

### å¤‰æ›´ (9ãƒ•ã‚¡ã‚¤ãƒ«)

| ãƒ•ã‚¡ã‚¤ãƒ« | å¤‰æ›´å†…å®¹ |
|---------|---------|
| `pages/layout/view.tsx` | SidebarView â†’ TabHeaderView ã«ç½®æ› |
| `pages/items/view.tsx` | 2ã‚«ãƒ©ãƒ ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ + ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ  + ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒªãƒ³ã‚¯ |
| `pages/items/presenter.ts` | URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å¯¾å¿œ (`?selected=<masterId>`) |
| `pages/skills/view.tsx` | 2ã‚«ãƒ©ãƒ ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ + ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ  |
| `pages/skills/presenter.ts` | URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å¯¾å¿œ |
| `pages/explores/view.tsx` | 2ã‚«ãƒ©ãƒ ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ + ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ  + ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒªãƒ³ã‚¯ |
| `pages/explores/presenter.ts` | URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å¯¾å¿œ |
| `pages/stages/view.tsx` | 2ã‚«ãƒ©ãƒ ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ + ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ  |
| `pages/stages/presenter.ts` | URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å¯¾å¿œ |

### å‰Šé™¤ (2ãƒ•ã‚¡ã‚¤ãƒ«)

| ãƒ•ã‚¡ã‚¤ãƒ« | ç†ç”± |
|---------|------|
| `components/sidebar/view.tsx` | TabHeaderã«ç½®æ› |
| `components/sidebar/index.tsx` | TabHeaderã«ç½®æ› |

### å¤‰æ›´ä¸è¦

- `components/relation-list/` - æ‹¡å¼µã—ã¦å†åˆ©ç”¨ï¼ˆonItemClickã«ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½è¿½åŠ ï¼‰
- `components/relation-editor/` - ãƒ¢ãƒ¼ãƒ€ãƒ«ã¯ãã®ã¾ã¾ä½¿ç”¨
- `components/data-table/` - ä»Šå›ã¯ä¸ä½¿ç”¨ã ãŒç¶­æŒ
- `components/detail-panel/` - ç¶­æŒï¼ˆå¿…è¦ãªã‚‰å‚ç…§ï¼‰
- `types/`, `api/` - å¤‰æ›´ãªã—

---

## å®Ÿè£…è©³ç´°

### 1. TabHeaderView

```tsx
// components/tab-header/view.tsx
type TabHeaderViewProps = {
  onSave: () => void;
  onReload: () => void;
  isSaving: boolean;
  hasChanges: boolean;
};

const tabs = [
  { to: "/items", label: "ã‚¢ã‚¤ãƒ†ãƒ " },
  { to: "/skills", label: "ã‚¹ã‚­ãƒ«" },
  { to: "/explores", label: "æ¢ç´¢" },
  { to: "/stages", label: "ã‚¹ãƒ†ãƒ¼ã‚¸" },
];

// DaisyUI tabs tabs-boxed + NavLink
```

### 2. RecordListView

```tsx
// components/record-list/view.tsx
type RecordListViewProps<T extends { id: number }> = {
  items: T[];
  selectedId: number | null;
  onSelect: (id: number) => void;
  onAdd: () => void;
  getDisplayName: (item: T) => string;
};

// DaisyUI menu + é¸æŠçŠ¶æ…‹ãƒã‚¤ãƒ©ã‚¤ãƒˆ
```

### 3. RecordDetailView

```tsx
// components/record-detail/view.tsx
type RecordDetailViewProps = {
  title: string;
  children: ReactNode;
  onDelete: () => void;
};

// ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆã‚¿ã‚¤ãƒˆãƒ« + å‰Šé™¤ãƒœã‚¿ãƒ³ï¼‰+ children
```

### 4. FieldEditorView

```tsx
// components/field-editor/view.tsx
type Field = {
  key: string;
  label: string;
  type: "text" | "number";
  editable?: boolean;
};

type FieldEditorViewProps = {
  fields: Field[];
  values: Record<string, string | number>;
  onUpdate: (key: string, value: string | number) => void;
};

// ã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã§ãƒ©ãƒ™ãƒ« + inputãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
```

### 5. useNavigateToRecord

```tsx
// hooks/useNavigateToRecord.ts
export function useNavigateToRecord() {
  const navigate = useNavigate();

  return (targetType: "items" | "skills" | "explores" | "stages", masterId: number) => {
    navigate(`/${targetType}?selected=${masterId}`);
  };
}
```

### 6. å„ãƒšãƒ¼ã‚¸ã®URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å¯¾å¿œ

```tsx
// presenter.ts ã«è¿½åŠ 
const [searchParams] = useSearchParams();

useEffect(() => {
  const selectedParam = searchParams.get("selected");
  if (selectedParam && data.length > 0) {
    const masterId = Number(selectedParam);
    // ãƒã‚¹ã‚¿ãƒ¼IDã‹ã‚‰ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æ¤œç´¢
    const record = data.find(item => getMasterId(item) === masterId);
    if (record) {
      setSelectedId(record.id);
    }
  }
}, [searchParams, data]);
```

### 7. RelationListView ã®æ‹¡å¼µ

æ—¢å­˜ã® `onItemClick` ã«é·ç§»æ©Ÿèƒ½ã‚’å®Ÿè£…ï¼š

```tsx
// items/view.tsx ã§ã®ä½¿ç”¨ä¾‹
<RelationListView
  title="ç²å¾—ã§ãã‚‹æ¢ç´¢"
  items={relatedExplores.earning.map(e => ({
    id: e.id,
    label: e.label,
    description: e.description,
    exploreId: e.exploreId,  // è¿½åŠ 
  }))}
  onItemClick={(id) => {
    const item = relatedExplores.earning.find(e => e.id === id);
    if (item) navigateToRecord("explores", item.exploreId);
  }}
  onRemove={onRemoveEarning}
  onAdd={() => handleOpenModal("earning")}
/>
```

---

## å®Ÿè£…é †åº

### Phase 1: æ–°è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä½œæˆ
1. `components/tab-header/`
2. `components/record-list/`
3. `components/record-detail/`
4. `components/field-editor/`
5. `hooks/useNavigateToRecord.ts`

### Phase 2: ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå¤‰æ›´
1. `pages/layout/view.tsx` - TabHeaderã«ç½®æ›
2. `components/sidebar/` å‰Šé™¤

### Phase 3: ãƒšãƒ¼ã‚¸å¤‰æ›´ï¼ˆ1ãƒšãƒ¼ã‚¸ãšã¤ï¼‰
1. `pages/items/` - 2ã‚«ãƒ©ãƒ åŒ– + URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ + ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ  + ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒªãƒ³ã‚¯
2. `pages/explores/` - åŒæ§˜
3. `pages/skills/` - åŒæ§˜ï¼ˆãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãªã—ï¼‰
4. `pages/stages/` - åŒæ§˜ï¼ˆãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãªã—ï¼‰

### Phase 4: å‹•ä½œç¢ºèª
- ã‚¿ãƒ–åˆ‡æ›¿
- ãƒ¬ã‚³ãƒ¼ãƒ‰é¸æŠãƒ»ç·¨é›†
- ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒªãƒ³ã‚¯é·ç§»
- æ–°è¦ä½œæˆãƒ»å‰Šé™¤

---

## æ³¨æ„äº‹é …

### ãƒã‚¹ã‚¿ãƒ¼IDã¨ãƒ†ãƒ¼ãƒ–ãƒ«IDã®åŒºåˆ¥

| ãƒã‚¹ã‚¿ | ãƒ†ãƒ¼ãƒ–ãƒ«ID | ãƒã‚¹ã‚¿ãƒ¼ID |
|-------|-----------|-----------|
| Item | `id` | `item_id` |
| Skill | `id` | `SkillId` |
| Explore | `id` | `ExploreId` |
| Stage | `id` | `stage_id` |

ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«ã§ã¯ãƒã‚¹ã‚¿ãƒ¼IDã‚’ä½¿ç”¨ã€‚é·ç§»æ™‚ã¯ãƒã‚¹ã‚¿ãƒ¼IDã‚’æ¸¡ã™ã€‚

### ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®æ–¹å‘

| èµ·ç‚¹ | ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ | é·ç§»å…ˆ |
|-----|-------------|-------|
| Item | EarningItem | â†’ Explore |
| Item | ConsumingItem | â†’ Explore |
| Item | ItemExploreRelation | â†’ Explore |
| Explore | EarningItem | â†’ Item |
| Explore | ConsumingItem | â†’ Item |
| Explore | RequiredSkill | â†’ Skill |
| Explore | SkillGrowth | â†’ Skill |
